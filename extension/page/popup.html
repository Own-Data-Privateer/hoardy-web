<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>pWebArc: Settings</title>
    <link rel="shortcut icon" type="image/svg" href="../icon/on.svg">
    <link rel="stylesheet" href="main.css">
    <style>
body {
    line-height: 160%;
}

h1 {
    font-size: 110%;
    margin: 0;
    margin-top: 5px;
}

h2 {
    font-size: 100%;
    margin: 0;
    margin-top: 2px;
}

.right {
    margin-left: auto;
}

#stats > div, #stats > h1 {
    display: flex;
}

input[type="button"], .help {
    vertical-align: top;
}

#show {
    width: 99%;
    text-align: center;
    margin: 5px;
}

.disabled-archiving {
    --text-background: var(--uncheckbox-background);
    --text-border-color: var(--uncheckbox-border-color);
}

.disabled-collecting {
    --checkbox-background: var(--uncheckbox-background);
    --checkbox-border-color: var(--uncheckbox-border-color);
}
    </style>
  </head>
  <body style="display: none">
    <div id="main">
      <div id="stats">
        <h1>Stats
          <span class="right">
            <span data-help="Open the request log page."><input type="button" id="log" value="Log" /></span>
            <span data-help="Open the help page."><input type="button" id="help" value="Help" /></span>
          </span>
        </h1>
        <div id="div-stats.archived" data-help="Reqres (HTTP requests+responses) successfully archived to the server.">
          <span>Archived</span>
          <span class="right"><span id="stats.archived">0</span> reqres</span>
        </div>
        <div id="div-stats.failedToArchive" data-help="Reqres that failed to be archived to the server.">
          <span>Failed to archive</span>
          <span class="right">
            <span data-help="Move all failed to archive reqres to the archiving queue. This action will be performed automatically every 60 seconds when archiving is enabled."><input type="button" id="retryAllFailedArchives" value="Retry" /></span>
            <span id="stats.failedToArchive">0</span> reqres
          </span>
        </div>
        <div id="div-stats.queued" data-help="Finished reqres queued for archival.">
          <span>Queued for archival</span>
          <span class="right"><span id="stats.queued">0</span> reqres</span></div>
        <div id="div-stats.failedToFetch" data-help="Finished reqres that failed to satisfy the archiving conditions and thus were discarded.">
          <span>Discarded</span>
          <span class="right"><span id="stats.failedToFetch">0</span> reqres</span>
        </div>
        <div id="div-stats.inflight" data-help="Tracked reqres that have not finished yet.">
          <span>In-flight</span>
          <span class="right">
            <span data-help="Stop tracking progress of all in-flight requests and either queue them for archival or fail them, depending on completion and &quot;Archive reqres with&quot; options below."><input type="button" id="forceFinishRequests" value="Stop" /></span>
            <span id="stats.inflight">0</span> reqres
          </span>
        </div>
      </div>
      <h1>Globally</h1>
      <ui id="config.collecting" data-help="Generate and start tracking a new reqres when browser makes a new HTTP request. Disabling this option will stop pWebArc from recording any new data.">Track any new reqres at all</ui>
      <div name="more">
        <ui id="config.archiving" data-help="Archive already collected reqres (&quot;queued for archival&quot; in the stats) by submitting their dumps to the server at the following URL. Disabling this will stop pWebArc from trying to archive already collected data. Note that the archival queue is stored in memory, so you probably should not disable this unless you want to atomically change server-side profile settings or your server is temporarily down and you are annoyed by the error notifications.">Archive collected reqres</ui>
        <div name="depends">
          <ui id="config.archiveURLBase" data-help="URL of the server we are archiving to.">Archive to</ui>
        </div>
      </div>
      <div name="depends">
        <h1>This tab</h1>
        <ui id="tabconfig.collecting" data-help="Track new reqres originating from this tab.">Track new reqres from this tab</ui>
        <ui id="tabconfig.profile" data-help="Use this server-side profile when archiving reqres originating from this tab.">Profile</ui>
        <h1>New tabs opened from this tab</h1>
        <ui id="tabconfig.children.collecting" data-help="Track reqres originating from new tabs spawned from this tab (e.g. via middle mouse click, context menu, etc).">Track reqres in such tabs</ui>
        <ui id="tabconfig.children.profile" data-help="Use this server-side profile when archiving reqres originating from new tabs opened from this tab (e.g. via middle mouse click).">Profile</ui>
        <h1>New root tabs</h1>
        <ui id="config.root.collecting" data-help="Track reqres originating from new tabs opened via browser's &quot;New Tab&quot; browser action (i.e. the plus sign in the tab bar, Control+T, menu item, etc).">Track reqres in new root tabs</ui>
        <ui id="config.root.profile" data-help="Use this server-side profile when archiving reqres originating from new tabs opened via browser's &quot;New Tab&quot; browser action.">Profile</ui>
      </div>
    </div>

    <input type="button" id="show" value="Show all" />

    <div name="more">
      <div name="depends">
        <h1>Originating from extensions</h1>
        <ui id="config.extension.collecting" data-help="Track new reqres originating from other browser extensions.">Track reqres from extensions</ui>
        <ui id="config.extension.profile" data-help="Use this server-side profile when archiving reqres originating from other browser extensions.">Profile</ui>
        <h1>Other background tasks</h1>
        <ui id="config.background.collecting" data-help="Track new reqres originating from browser's background tasks (excluding those originating from extensions). With the default browser config you probably should not disable this, as browsers do link pre-fetching in background, and disabling this will miss that data.">Track reqres from background tasks</ui>
        <ui id="config.background.profile" data-help="Use this server-side profile when archiving reqres originating from browser's background tasks.">Profile</ui>
        <h1>Options</h1>
        <div id="archive-options">
          <h2>Archive reqres with</h2>
          <ui id="config.archivePartialRequest" data-help="Queue a reqres for archival even when its request body is incomplete. You probably want to keep this enabled. See the &quot;Quirks&quot; section of the &quot;Help&quot; page for details.">... partial POST form data</ui>
          <ui id="config.archiveNoResponse" data-help="Queue a reqres for archival even when there was no response, i.e. request was interrupted before request headers were received (this usually means a networking issue). Disabled by default because such archived reqress carry no information except that the browser tried to do a request at specified time.">... no responses</ui>
          <ui id="config.archiveIncompleteResponse" data-help="Queue a reqres for archival even when its response body is incomplete (e.g. response body was interrupted in the middle by a networking issue). Disabled by default because simply reloading the page and not dealing with partial files is usually a better option.">... incomplete response bodies</ui>
        </div>
        <div id="misc-options">
          <h2>Misc</h2>
          <ui id="config.debugging" data-help="This makes extension's debugging log in about:debugging much more verbose. Makes things very slow, eats lots of memory. Do not enable unless you know what you are doing.">Print verbose debugging log (very slow!)</ui>
        </div>
      </div>
    </div>
    <script src="../lib/utils.js"></script>
    <script src="popup.js"></script>
  </body>
</html>
